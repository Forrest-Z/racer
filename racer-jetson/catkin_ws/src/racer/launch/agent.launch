<launch>
    <arg name="circuit" />
    <arg name="base_link_frame_id" default="base_link" />

    <group>
        <node pkg="racer" name="circuit_analysis" type="circuit_node" output="screen">
          <rosparam command="load" file="$(arg circuit)" />
          <param name="lookahead" value="8" />
        </node>

        <node pkg="racer" name="state" type="current_state_node" output="screen">
          <param name="frequency" value="25" />
          <param name="base_link_frame_id" value="$(arg base_link_frame_id)" />
          <param name="motor_rpm_topic" value="/racer/motor_rpm" />
        </node>

        <node pkg="racer" name="planning" type="planning_node" output="screen">
          <param name="map_topic" value="/obstacles/costmap/costmap" />
          <param name="frequency" value="5" />

          <param name="throttle_levels" value="6" />
          <param name="steering_levels" value="7" />
        </node>

        <group>
            <node pkg="racer" name="following" type="dwa_following_node" output="screen">
                <param name="map_topic" value="/obstacles/costmap/costmap" />
                <param name="prediction_horizon_s" value="0.75" />

                <param name="distance_to_obstacle_weight" value="2.0" />
                <param name="position_weight" value="5.0" />
                <param name="heading_weight" value="6.0" />
                <param name="velocity_weight" value="1.0" />

                <param name="frequency" value="50" />

                <param name="ackermann_topic" value="/racer/ackermann_commands" />
            </node>
        </group>

        <!--<group>
            <node pkg="racer" name="following" type="geometric_following_node" output="screen">
                <param name="map_topic" value="/obstacles/costmap/costmap" />
                <param name="min_lookahead" value="1" />
                <param name="max_allowed_speed_percentage" value="0.1" />
                <param name="frequency" value="15" />
                <param name="ackermann_topic" value="/car_1/command" />

                <param name="pid_speed_kp" value="1.0" />
                <param name="pid_speed_ki" value="0.0" />
                <param name="pid_speed_kd" value="1.0" />
            </node>
        </group>-->
    </group>
</launch>
