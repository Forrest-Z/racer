<launch>

  <node pkg="bno055_usb_stick" type="bno055_usb_stick_node" name="imu_node" output="screen">
    <param name="port" type="string" value="/dev/imu" />
    <param name="publish_tf" type="bool" value="true" />
    <param name="frame_id" type="string" value="imu_frame" />
  </node>

  <node name="ydliar" pkg="ydlidar" type="ydlidar_node" output="screen">
    <param name="port" type="string" value="/dev/lidar" />
    <param name="baudrate" type="int" value="115200" />
    <param name="frame_id" type="string" value="laser_frame" />
    <param name="frequency" type="int" value="10" />
    <param name="sample_rate" type="int" value="5" />
    <param name="range_min" type="double" value="0.35" />
    <param name="range_max" type="double" value="16" />
  </node>

  <node pkg="tf" type="static_transform_publisher" name="base_link_2_laser_frame" args="0 0 0 0 0 0 base_link laser_frame 100" />
  <node pkg="tf" type="static_transform_publisher" name="base_link_2_imu_frame" args="0 0 0 0 0 0 base_link imu_frame 100" />

  <node pkg="hector_mapping" type="hector_mapping" name="hector_mapping" output="screen">
    <param name="scan_topic" value="scan" />
    <param name="base_frame" value="base_link" />
    <param name="odom_frame" value="odom" />
    <param name="output_timing" value="false"/>
    <param name="advertise_map_service" value="true"/>
    <param name="use_tf_scan_transformation" value="true"/>
    <param name="use_tf_pose_start_estimate" value="false"/>
    <param name="pub_map_odom_transform" value="true"/>
    <param name="map_with_known_poses" value="false"/>
    <param name="map_pub_period" value="0.5"/>
    <param name="update_factor_free" value="0.45"/>
    <param name="map_update_distance_thresh" value="0.02"/>
    <param name="map_update_angle_thresh" value="0.1"/>
    <param name="map_resolution" value="0.1"/>
    <param name="map_size" value="512"/>
    <param name="map_start_x" value="0.5"/>
    <param name="map_start_y" value="0.5"/>
  </node>

  <node pkg="rosserial_python" type="serial_node.py" name="arduino_control">
    <param name="port" value="/dev/arduino" />
  </node>

  <node pkg="rosserial_python" type="serial_node.py" name="arduino_odometry">
    <param name="port" value="/dev/arduino_odometry" />
  </node>

  <node pkg="odometry" type="odometry_node" name="odometry_node">
    <param name="base_link" value="base_link" />
    <param name="odom_frame" value="odom" />
    <param name="wheelbase" type="double" value="0.3" />
    <param name="rear_wheel_radius" type="double" value="0.1" />
    <param name="max_steering_angle" type="double" value="30" />
  </node>

  <!-- camera doesn't work at the moment -->
  <!--include file="$(find raspicam_node)/launch/camerav2_410x308_30fps.launch" /-->

</launch>
